<?xml version="1.0" encoding="EUC-KR"?>
<statements>

    <!--  -->
    <statement name="regtGcbRcetReisHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역등록" >
		<![CDATA[
			INSERT /*+ 송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/regtGcbRcetReisHis */
			  INTO INSTC.TBGCBRP03
			(
			   거래기준년월일
			 , 거래부점코드
			 , 원거래GUID번호
			 , 거래상태구분코드
			 , 고객계좌번호
			 , 영수증인자관리번호
			 , 카드식별자
			 , 고객식별자
			 , 고객관리번호
			 , 거래시각
			 , 거래금액
			 , 고객명
			 , 영수증재발행횟수
			 , 영수증최종재발행년월일
			 , 시스템최종갱신일시
			 , 시스템최종갱신식별자
			 , 시스템최종거래일시
			)
			VALUES
			(
			  ${거래기준년월일}
			 ,${거래부점코드}
			 ,${원거래GUID번호}
			 ,${거래상태구분코드}
			 ,${고객계좌번호}
			 ,${영수증인자관리번호}
			 ,${카드식별자}
			 ,${고객식별자}
			 ,${고객관리번호}
			 ,${거래시각}
			 ,${거래금액}
			 ,${고객명}
			 ,${영수증재발행횟수}
			 ,${영수증최종재발행년월일}
			 ,SYSTIMESTAMP
			 ,${시스템최종갱신식별자}
			 ,${시스템최종거래일시}
			)
		]]>
    </statement>

    <!--  -->
    <statement name="retvLckGcbRcetReisHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역락조회">
		<![CDATA[
			SELECT /*+ 송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/retvLckGcbRcetReisHis */ 
			       A.거래기준년월일
			     , A.거래부점코드
			     , A.원거래GUID번호
			     , A.거래상태구분코드
			     , A.고객계좌번호
			     , A.영수증인자관리번호
			     , A.카드식별자
			     , A.고객식별자
			     , A.고객관리번호
			     , A.거래시각
			     , A.거래금액
			     , A.고객명
			     , A.영수증재발행횟수
			     , A.영수증최종재발행년월일
			     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
			     , A.시스템최종갱신식별자
			     , A.시스템최종거래일시
			  FROM INSTC.TBGCBRP03 A 
			 WHERE A.거래기준년월일   = ${거래기준년월일}
			   AND A.거래부점코드    = ${거래부점코드}
			   AND A.원거래GUID번호 = ${원거래GUID번호}
			   FOR UPDATE NOWAIT   
		]]>
    </statement>

    <!--  -->
    <statement name="delGcbRcetReisHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역삭제" >
		<![CDATA[
			DELETE /*+ 송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/delGcbRcetReisHis */
			  FROM INSTC.TBGCBRP03  
			 WHERE 거래기준년월일   = ${거래기준년월일}
			   AND 거래부점코드    = ${거래부점코드}
			   AND 원거래GUID번호 = ${원거래GUID번호}
		]]>
    </statement>

    <!--  -->
    <statement name="uptGcbRcetReisHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역수정" >
		<![CDATA[
			UPDATE /*+ 송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/uptGcbRcetReisHis */ 
			       INSTC.TBGCBRP03 
			   SET 거래상태구분코드    = ${거래상태구분코드}
			     , 고객계좌번호      = ${고객계좌번호}
			     , 영수증인자관리번호   = ${영수증인자관리번호}
			     , 카드식별자       = ${카드식별자}
			     , 고객식별자       = ${고객식별자}
			     , 고객관리번호      = ${고객관리번호}
			     , 거래시각        = ${거래시각}
			     , 거래금액        = ${거래금액}
			     , 고객명         = ${고객명}
			     , 영수증재발행횟수    = ${영수증재발행횟수}
			     , 영수증최종재발행년월일 = ${영수증최종재발행년월일}
			     , 시스템최종갱신일시   = SYSTIMESTAMP
			     , 시스템최종갱신식별자  = ${시스템최종갱신식별자}
			     , 시스템최종거래일시   = ${시스템최종거래일시}
			 WHERE 거래기준년월일   = ${거래기준년월일}
			   AND 거래부점코드    = ${거래부점코드}
			   AND 원거래GUID번호 = ${원거래GUID번호}
		]]>
    </statement>

    <!--  -->
    <statement name="retvGcbRcetReisHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역조회" >
		<![CDATA[
			SELECT /*+ 송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/retvGcbRcetReisHis */ 
			       A.거래기준년월일
			     , A.거래부점코드
			     , A.원거래GUID번호
			     , A.거래상태구분코드
			     , A.고객계좌번호
			     , A.영수증인자관리번호
			     , A.카드식별자
			     , A.고객식별자
			     , A.고객관리번호
			     , A.거래시각
			     , A.거래금액
			     , A.고객명
			     , A.영수증재발행횟수
			     , A.영수증최종재발행년월일
			     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
			     , A.시스템최종갱신식별자
			     , A.시스템최종거래일시
			  FROM INSTC.TBGCBRP03 A 
			 WHERE A.거래기준년월일   = ${거래기준년월일}
			   AND A.거래부점코드    = ${거래부점코드}
			   AND A.원거래GUID번호 = ${원거래GUID번호}
		]]>
    </statement>

    <!--  -->
    <statement name="retvLstGcbRcetReisHisByTg" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::08.전표재인자::GCB영수증재발행내역Ebi::GCB영수증재발행내역Dao::GCB영수증재발행내역By대상목록조회">
		<![CDATA[
			SELECT /*+LEADING(T1) USE_NL(A)
			       ,  송재복::/gcb/slpRePrt/gcbRcetReisHisEbi/TBGCBRP03/retvLstGcbRcetReisHisByTg */ 
			       A.거래기준년월일
			     , A.거래부점코드
			     , A.원거래GUID번호
			     , A.거래상태구분코드
			     , A.고객계좌번호
			     , A.영수증인자관리번호
			     , A.카드식별자
			     , A.고객식별자
			     , A.고객관리번호
			     , A.거래시각
			     , A.거래금액
			     , A.고객명
			     , A.영수증재발행횟수
			     , A.영수증최종재발행년월일
			  FROM INSTC.TBGCBRP03 A 
			     , ( SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP03 A
			          WHERE ${고객식별자}         IS NOT NULL 
			            AND A.고객식별자          = ${고객식별자}
			            AND A.고객관리번호        = ${고객관리번호}
			            AND A.거래기준년월일 BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.거래부점코드   BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP03 A
			          WHERE ${영수증인자관리번호} IS NOT NULL 
			            AND A.영수증인자관리번호  = ${영수증인자관리번호}
			            AND A.거래기준년월일 BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.거래부점코드   BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP03 A
			          WHERE ${카드식별자}         IS NOT NULL
			            AND A.카드식별자          = ${카드식별자}
			            AND A.거래기준년월일 BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.거래부점코드   BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP03 A
			          WHERE ${고객계좌번호1}      IS NOT NULL
			            AND A.고객계좌번호        IN ( ${고객계좌번호1}, ${고객계좌번호2} )
			            AND A.거래기준년월일 BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.거래부점코드   BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			       ) T1
			  WHERE T1.RID = A.ROWID
			UNION ALL
			SELECT /*+LEADING(T2) USE_NL(A) */
			       A.기준년월일  거래기준년월일
			     , A.부점코드    거래부점코드
			     , A.원거래GUID번호
			     , A.거래상태구분코드
			     , A.고객계좌번호
			     , A.영수증인자관리번호
			     , A.카드식별자
			     , A.고객식별자
			     , A.고객관리번호
			     , A.거래시각
			     , A.거래금액
			     , A.고객명
			     , A.영수증재발행횟수
			     , A.영수증최종재발행년월일
			  FROM INSTC.TBGCBRP13 A 
			     , ( SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP13 A
			          WHERE ${고객식별자}         IS NOT NULL 
			            AND A.고객식별자          = ${고객식별자}
			            AND A.고객관리번호        = ${고객관리번호}
			            AND A.기준년월일    BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.부점코드      BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP13 A
			          WHERE ${영수증인자관리번호} IS NOT NULL 
			            AND A.영수증인자관리번호  = ${영수증인자관리번호}
			            AND A.기준년월일    BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.부점코드      BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP13 A
			          WHERE ${카드식별자}         IS NOT NULL
			            AND A.카드식별자          = ${카드식별자}
			            AND A.기준년월일    BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.부점코드      BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			         UNION 
			         SELECT ROWID AS RID
			           FROM INSTC.TBGCBRP13 A
			          WHERE ${고객계좌번호1}      IS NOT NULL
			            AND A.고객계좌번호        IN ( ${고객계좌번호1}, ${고객계좌번호2} )
			            AND A.기준년월일    BETWEEN ${조회시작년월일}      AND ${조회종료년월일}
			            AND A.부점코드      BETWEEN ${조회시작부점코드_V4} AND ${조회종료부점코드_V4}
			       ) T2
			  WHERE T2.RID = A.ROWID
		]]>
    </statement>
</statements>
