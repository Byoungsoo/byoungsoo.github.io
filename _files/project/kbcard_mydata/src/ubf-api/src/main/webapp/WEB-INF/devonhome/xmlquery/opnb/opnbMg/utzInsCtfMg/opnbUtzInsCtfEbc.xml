<?xml version="1.0" encoding="EUC-KR"?>
<statements>


    <!-- 오픈뱅킹토큰기본 조회 -->
    <statement name="selectTkenInfCtg">
		<![CDATA[
			SELECT /*+ 김정화::/opnb/opnbMg/utzInsCtfMg/opnbUtzInsCtfEbc/selectTkenInfCtg */ 
		 	         오픈뱅킹접근토큰내용 
				, 오픈뱅킹토큰발급일시
				, 오픈뱅킹토큰만료일시 
				, 오픈뱅킹토큰범위구분코드 
				, 오픈뱅킹토큰최종여부 
              FROM INSTC.TBUBFS015      /* UBF오픈뱅킹토큰기본 */       
             WHERE 오픈뱅킹토큰최종여부 = 'Y'
               AND NVL(TRIM(${오픈뱅킹접근토큰내용}), ' ') != ' '
               AND 오픈뱅킹접근토큰내용 = ${오픈뱅킹접근토큰내용}
             UNION ALL
            SELECT
            	   오픈뱅킹접근토큰내용 
				, 오픈뱅킹토큰발급일시 
				, 오픈뱅킹토큰만료일시 
				, 오픈뱅킹토큰범위구분코드 
				, 오픈뱅킹토큰최종여부 
              FROM INSTC.TBUBFS015      /* UBF오픈뱅킹토큰기본 */       
             WHERE 오픈뱅킹토큰최종여부 = 'Y'
               AND NVL(TRIM(${오픈뱅킹접근토큰내용}), ' ') = ' '
		]]>
    </statement>

    <!-- 오픈뱅킹토큰기본 수정 -->
    <statement name="updateTken">
		<![CDATA[
			UPDATE /*+ 김정화::/opnb/opnbMg/utzInsCtfMg/opnbUtzInsCtfEbc/updateTken */ 
                   INSTC.TBUBFS015        /* UBF오픈뱅킹토큰기본 */
               SET 오픈뱅킹토큰최종여부           = ${오픈뱅킹토큰최종여부}      
               	 , 오픈뱅킹토큰만료일시           = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
                 , 시스템최종갱신일시              = SYSTIMESTAMP          
                 , 시스템최종갱신식별자            = ${시스템최종갱신식별자}        
                 , 시스템최종거래일시              = ${시스템최종거래일시}         
             WHERE 오픈뱅킹접근토큰내용          = ${오픈뱅킹접근토큰내용}
		]]>
    </statement>
    
</statements>
