<?xml version="1.0" encoding="EUC-KR"?>
<statements>

    <!--  -->
    <!-- 20210516 최웅기 CDC 테이블명 변경  TBGCBER01	:: TBUBDJ001
    <statement name="retvLstGCB_ItOpSmsTgTnhsErrLog" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::12.IT운영SMS관리::GCB_IT운영SMS대상거래내역Ebi::GCB_IT운영SMS대상거래내역Dao::GCB_IT운영SMS대상거래내역오류로그목록조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/itOpSmsMg/gCB_ItOpSmsTgTnhsEbi/TBGCBSM13/retvLstGCB_ItOpSmsTgTnhsErrLog */ 
			       A.오류거래발생년월일
			     , A.오류거래발생시각
			     , A.거래직원번호
			     , A.거래코드
			     , (SELECT SUBSTRB(B.통합코드내용, 1, 50) 거래코드명
			          FROM INSTC.TBGCBUI02 B
			         WHERE A.거래코드 = B.통합코드
			           AND A.오류거래발생년월일 >= B.적용시작년월일
			           AND A.오류거래발생년월일 <= B.적용종료년월일
			           AND B.통합코드명 = '거래코드'
			           AND ROWNUM = 1) 거래코드명_V50
			     , A.오류메시지코드
			     , (SELECT CASE WHEN SUBSTRB(C.오류메시지코드, 1, 1) = 'I' AND INSTR(C.오류메시지출력내용, '(') > 0
			                    THEN SUBSTRB(C.오류메시지출력내용, INSTR(C.오류메시지출력내용, '('), 50)
			                    ELSE SUBSTRB(C.오류메시지출력내용, 1, 50)
			                END 오류메시지코드명
			          FROM INSTC.TBGCBER01 C
			         WHERE A.오류메시지코드 = C.오류메시지코드
			           AND A.오류거래발생년월일 >= C.적용시작년월일
			           AND A.오류거래발생년월일 <= C.적용종료년월일
			           AND C.언어구분코드 = 'KOR'
			           AND C.메시지채널구분코드 = '01'
			           AND ROWNUM = 1) 오류메시지코드명_V50
			     , A.조치메시지코드
			     , (SELECT SUBSTRB(D.오류메시지출력내용, 1, 50)
			          FROM INSTC.TBGCBER01 D
			         WHERE A.조치메시지코드 = D.오류메시지코드
			           AND A.오류거래발생년월일 >= D.적용시작년월일
			           AND A.오류거래발생년월일 <= D.적용종료년월일
			           AND D.언어구분코드 = 'KOR'
			           AND D.메시지채널구분코드 = '01'
			           AND ROWNUM = 1) 조치메시지코드명_V50
			     , A.GUID번호
			     , A.거래유형구분코드
			     , A.중계인터페이스구분코드
			     , A.채널구분코드
			     , A.채널세부업무구분코드
			     , CASE WHEN 거래코드 = SUBSTRB(A.연동대표거래코드, 1, 10)
			            THEN '대표 (' || SUBSTRB(A.연동대표거래코드, 11, 2) || ')'
			            ELSE A.연동대표거래코드
			        END 연동대표거래코드
			     , A.취소구분코드
			     , A.취소유형구분코드
			     , A.부점코드
			     , A.단말번호
			     , A.화면번호
			     , A.책임자승인구분코드
			     , A.승인완료구분코드
			     , A.입력매체부분정보유무
			     , A.IT운영SMS전송여부
			     , A.IT운영SMS전송일시
			     , A.IT운영SMS전송대상자식별내용01
			     , A.IT운영SMS전송대상자식별내용02
			     , A.IT운영SMS전송대상자식별내용03
			     , A.IT운영SMS전송대상자식별내용04
			     , A.IT운영SMS전송대상자식별내용05
			     , A.IT운영SMS전송대상자식별내용06
			     , A.IT운영SMS전송대상자식별내용07
			     , A.IT운영SMS전송대상자식별내용08
			     , A.IT운영SMS전송대상자식별내용09
			     , A.IT운영SMS전송대상자식별내용10
			     , A.IT운영SMS전송대상자식별내용11
			     , A.IT운영SMS전송대상자식별내용12
			     , A.IT운영SMS전송대상자식별내용13
			     , A.IT운영SMS전송대상자식별내용14
			     , A.IT운영SMS전송대상자식별내용15
			     , A.IT운영SMS전송대상자식별내용16
			     , A.IT운영SMS전송대상자식별내용17
			     , A.IT운영SMS전송대상자식별내용18
			     , A.IT운영SMS전송대상자식별내용19
			     , A.IT운영SMS전송대상자식별내용20
			     , A.IT운영SMS비고
			     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시_V20
			     , A.시스템최종갱신식별자
			     , A.시스템최종거래일시
			  FROM INSTC.TBGCBSM13 A 
			 WHERE A.오류거래발생년월일 >= ${오류거래발생년월일1}
			   AND A.오류거래발생년월일 <= ${오류거래발생년월일2}
			   AND A.오류거래발생년월일 || A.오류거래발생시각 >= ${오류거래발생년월일1} || ${오류거래발생시각1}
			   AND A.오류거래발생년월일 || A.오류거래발생시각 <= ${오류거래발생년월일2} || ${오류거래발생시각2}
			   AND (${메시지코드체크_V1} != '1' OR (A.거래코드 LIKE '%' || ${거래코드} || '%' AND
			                                   A.오류메시지코드 LIKE '%' || ${오류메시지코드} || '%' AND
			                                   A.조치메시지코드 LIKE '%' || ${조치메시지코드} || '%'))
			   AND (${GUID번호체크_V1} != '1' OR SUBSTR(GUID번호, 1, 33) = ${GUID번호})
			   AND (${채널구분체크_V1} != '1' OR ((${중계인터페이스구분코드} IS NULL OR A.중계인터페이스구분코드 = ${중계인터페이스구분코드}) AND 
			                                  (${채널구분코드} IS NULL OR A.채널구분코드 = ${채널구분코드}) AND
			                                  (${채널세부업무구분코드} IS NULL OR A.채널세부업무구분코드 = ${채널세부업무구분코드})))
			   AND (${SMS수신직원체크_V1} != '1' OR
			        IT운영SMS전송대상자식별내용01 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용02 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용03 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용04 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용05 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용06 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용07 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용08 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용09 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용10 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용11 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용12 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용13 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용14 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용15 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용16 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용17 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용18 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용19 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용20 LIKE '%' || ${직원번호} || '%')
		]]>
    </statement>
    -->
    <statement name="retvLstGCB_ItOpSmsTgTnhsErrLog" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::05.엔터티컴포넌트::12.IT운영SMS관리::GCB_IT운영SMS대상거래내역Ebi::GCB_IT운영SMS대상거래내역Dao::GCB_IT운영SMS대상거래내역오류로그목록조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/itOpSmsMg/gCB_ItOpSmsTgTnhsEbi/TBGCBSM13/retvLstGCB_ItOpSmsTgTnhsErrLog */ 
			       A.오류거래발생년월일
			     , A.오류거래발생시각
			     , A.거래직원번호
			     , A.거래코드
			     , (SELECT SUBSTRB(B.통합코드내용, 1, 50) 거래코드명
			          FROM INSTC.TBGCBUI02 B
			         WHERE A.거래코드 = B.통합코드
			           AND A.오류거래발생년월일 >= B.적용시작년월일
			           AND A.오류거래발생년월일 <= B.적용종료년월일
			           AND B.통합코드명 = '거래코드'
			           AND ROWNUM = 1) 거래코드명_V50
			     , A.오류메시지코드
			     , (SELECT CASE WHEN SUBSTRB(C.오류메시지코드, 1, 1) = 'I' AND INSTR(C.오류메시지출력내용, '(') > 0
			                    THEN SUBSTRB(C.오류메시지출력내용, INSTR(C.오류메시지출력내용, '('), 50)
			                    ELSE SUBSTRB(C.오류메시지출력내용, 1, 50)
			                END 오류메시지코드명
			          FROM INSTC.TBUBDJ001 C
			         WHERE A.오류메시지코드 = C.오류메시지코드
			           AND A.오류거래발생년월일 >= C.적용시작년월일
			           AND A.오류거래발생년월일 <= C.적용종료년월일
			           AND C.언어구분코드 = 'KOR'
			           AND C.메시지채널구분코드 = '01'
			           AND ROWNUM = 1) 오류메시지코드명_V50
			     , A.조치메시지코드
			     , (SELECT SUBSTRB(D.오류메시지출력내용, 1, 50)
			          FROM INSTC.TBUBDJ001 D
			         WHERE A.조치메시지코드 = D.오류메시지코드
			           AND A.오류거래발생년월일 >= D.적용시작년월일
			           AND A.오류거래발생년월일 <= D.적용종료년월일
			           AND D.언어구분코드 = 'KOR'
			           AND D.메시지채널구분코드 = '01'
			           AND ROWNUM = 1) 조치메시지코드명_V50
			     , A.GUID번호
			     , A.거래유형구분코드
			     , A.중계인터페이스구분코드
			     , A.채널구분코드
			     , A.채널세부업무구분코드
			     , CASE WHEN 거래코드 = SUBSTRB(A.연동대표거래코드, 1, 10)
			            THEN '대표 (' || SUBSTRB(A.연동대표거래코드, 11, 2) || ')'
			            ELSE A.연동대표거래코드
			        END 연동대표거래코드
			     , A.취소구분코드
			     , A.취소유형구분코드
			     , A.부점코드
			     , A.단말번호
			     , A.화면번호
			     , A.책임자승인구분코드
			     , A.승인완료구분코드
			     , A.입력매체부분정보유무
			     , A.IT운영SMS전송여부
			     , A.IT운영SMS전송일시
			     , A.IT운영SMS전송대상자식별내용01
			     , A.IT운영SMS전송대상자식별내용02
			     , A.IT운영SMS전송대상자식별내용03
			     , A.IT운영SMS전송대상자식별내용04
			     , A.IT운영SMS전송대상자식별내용05
			     , A.IT운영SMS전송대상자식별내용06
			     , A.IT운영SMS전송대상자식별내용07
			     , A.IT운영SMS전송대상자식별내용08
			     , A.IT운영SMS전송대상자식별내용09
			     , A.IT운영SMS전송대상자식별내용10
			     , A.IT운영SMS전송대상자식별내용11
			     , A.IT운영SMS전송대상자식별내용12
			     , A.IT운영SMS전송대상자식별내용13
			     , A.IT운영SMS전송대상자식별내용14
			     , A.IT운영SMS전송대상자식별내용15
			     , A.IT운영SMS전송대상자식별내용16
			     , A.IT운영SMS전송대상자식별내용17
			     , A.IT운영SMS전송대상자식별내용18
			     , A.IT운영SMS전송대상자식별내용19
			     , A.IT운영SMS전송대상자식별내용20
			     , A.IT운영SMS비고
			     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시_V20
			     , A.시스템최종갱신식별자
			     , A.시스템최종거래일시
			  FROM INSTC.TBGCBSM13 A 
			 WHERE A.오류거래발생년월일 >= ${오류거래발생년월일1}
			   AND A.오류거래발생년월일 <= ${오류거래발생년월일2}
			   AND A.오류거래발생년월일 || A.오류거래발생시각 >= ${오류거래발생년월일1} || ${오류거래발생시각1}
			   AND A.오류거래발생년월일 || A.오류거래발생시각 <= ${오류거래발생년월일2} || ${오류거래발생시각2}
			   AND (${메시지코드체크_V1} != '1' OR (A.거래코드 LIKE '%' || ${거래코드} || '%' AND
			                                   A.오류메시지코드 LIKE '%' || ${오류메시지코드} || '%' AND
			                                   A.조치메시지코드 LIKE '%' || ${조치메시지코드} || '%'))
			   AND (${GUID번호체크_V1} != '1' OR SUBSTR(GUID번호, 1, 33) = ${GUID번호})
			   AND (${채널구분체크_V1} != '1' OR ((${중계인터페이스구분코드} IS NULL OR A.중계인터페이스구분코드 = ${중계인터페이스구분코드}) AND 
			                                  (${채널구분코드} IS NULL OR A.채널구분코드 = ${채널구분코드}) AND
			                                  (${채널세부업무구분코드} IS NULL OR A.채널세부업무구분코드 = ${채널세부업무구분코드})))
			   AND (${SMS수신직원체크_V1} != '1' OR
			        IT운영SMS전송대상자식별내용01 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용02 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용03 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용04 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용05 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용06 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용07 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용08 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용09 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용10 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용11 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용12 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용13 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용14 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용15 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용16 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용17 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용18 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용19 LIKE '%' || ${직원번호} || '%' OR
			        IT운영SMS전송대상자식별내용20 LIKE '%' || ${직원번호} || '%')
		]]>
    </statement>
</statements>
