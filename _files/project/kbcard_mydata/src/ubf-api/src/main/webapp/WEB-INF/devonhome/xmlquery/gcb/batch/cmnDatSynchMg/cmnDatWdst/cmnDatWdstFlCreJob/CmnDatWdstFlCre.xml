<?xml version="1.0" encoding="EUC-KR"?>
<statements>

    <!--  -->
    <statement name="retvLstCmnDatWdstSvrBas" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::06.배치컴포넌트::01.공통데이터동기화관리::02.공통데이터배포::공통데이터배포파일생성1차Job::DAO::공통데이터배포파일생성Bdao::공통데이터배포서버기본목록조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/batch/cmnDatSynchMg/cmnDatWdst/cmnDatWdstFlCreJob/CmnDatWdstFlCre/retvLstCmnDatWdstSvrBas */ 
			       A.공통데이터테이블명
			     , A.배포작업시스템식별구분코드
			     , A.배포대상시스템ID
			     , A.시스템상태구분코드
			     , A.시스템운영환경구분코드
			     , A.배포대상시스템식별구분코드
			     , A.배포EAI거래코드
			     , A.배포대상서버IP주소
			     , A.배포대상시스템내용
			     , A.시스템최종갱신일시
			     , A.시스템최종갱신식별자
			     , A.시스템최종거래일시 
			  FROM INSTC.TBGCBDM04 A 
			 WHERE A.공통데이터테이블명   = ${공통데이터테이블명}
			   AND A.시스템운영환경구분코드 = ${시스템운영환경구분코드}
		]]>
    </statement>

    <!--  -->
    <statement name="retvCmnDatTblClmnNcn" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::06.배치컴포넌트::01.공통데이터동기화관리::02.공통데이터배포::공통데이터배포파일생성1차Job::DAO::공통데이터배포파일생성Bdao::공통데이터테이블컬럼건수조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/batch/cmnDatSynchMg/cmnDatWdst/cmnDatWdstFlCreJob/CmnDatWdstFlCre/retvCmnDatTblClmnNcn */ 
			       SUM(CNT) 공통데이터테이블컬럼건수_N5
			     , SUM(PK_COL) 공통데이터테이블PK컬럼건수_N5
			  FROM (SELECT COUNT(*) CNT
			             , 0 PK_COL
			          FROM SYS.ALL_TAB_COLS A
			         WHERE 1 = 1
			           AND A.OWNER = 'INSTC'
			           AND A.TABLE_NAME = ${공통데이터테이블명}
			         UNION ALL
			        SELECT 0 CNT
			             , COUNT(*) PK_COL
			          FROM SYS.ALL_CONSTRAINTS A
			             , SYS.ALL_CONS_COLUMNS B
			         WHERE 1 = 1
			           AND A.OWNER = B.OWNER
			           AND A.TABLE_NAME = B.TABLE_NAME
			           AND A.CONSTRAINT_NAME = B.CONSTRAINT_NAME
			           AND A.OWNER = 'INSTC'
			           AND A.CONSTRAINT_TYPE = 'P'
			           AND A.TABLE_NAME = ${공통데이터테이블명})
		]]>
    </statement>

    <!--  -->
    <statement name="retvLstCmnDatTblClmn" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::06.배치컴포넌트::01.공통데이터동기화관리::02.공통데이터배포::공통데이터배포파일생성1차Job::DAO::공통데이터배포파일생성Bdao::공통데이터테이블컬럼목록조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/batch/cmnDatSynchMg/cmnDatWdst/cmnDatWdstFlCreJob/CmnDatWdstFlCre/retvLstCmnDatTblClmn */ 
			       A.COLUMN_NAME 공통데이터테이블컬럼명_V128
			     , A.DATA_TYPE 공통데이터테이블컬럼타입_V128
			     , A.DATA_LENGTH 공통데이터테이블컬럼길이_N5
			     , A.DATA_SCALE 공통데이터테이블컬럼소수점길이_N5
			     , A.COLUMN_ID 공통데이터테이블컬럼ID_N5
			  FROM (SELECT COLUMN_NAME
			             , CASE WHEN DATA_TYPE = 'TIMESTAMP(6)' THEN 'VARCHAR2'
			                    ELSE DATA_TYPE
			                END DATA_TYPE
			             , CASE WHEN DATA_TYPE = 'NUMBER' THEN DATA_PRECISION
			                    WHEN DATA_TYPE = 'TIMESTAMP(6)' THEN 20
			                    ELSE DATA_LENGTH
			                END DATA_LENGTH
			             , CASE WHEN DATA_TYPE = 'TIMESTAMP(6)' THEN NULL
			                    ELSE DATA_SCALE
			                END DATA_SCALE
			             , COLUMN_ID
			          FROM SYS.ALL_TAB_COLS
			         WHERE 1 = 1
			           AND OWNER = 'INSTC'
			           AND TABLE_NAME = ${공통데이터테이블명}
			         ORDER BY COLUMN_ID) A
			 ORDER BY A.COLUMN_ID
		]]>
    </statement>

    <!--  -->
    <statement name="retvLstCmnDatTblPk" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::06.배치컴포넌트::01.공통데이터동기화관리::02.공통데이터배포::공통데이터배포파일생성Job::DAO::공통데이터배포파일생성Bdao::공통데이터테이블PK목록조회">
		<![CDATA[
			SELECT /*+ 위상규::/gcb/batch/cmnDatSynchMg/cmnDatWdst/cmnDatWdstFlCreJob/CmnDatWdstFlCre/retvLstCmnDatTblPk */ 
			       B.COLUMN_NAME 공통데이터테이블컬럼명_V128
			  FROM SYS.ALL_CONSTRAINTS A
			     , SYS.ALL_CONS_COLUMNS B
			 WHERE 1 = 1
			   AND A.OWNER = B.OWNER
			   AND A.TABLE_NAME = B.TABLE_NAME
			   AND A.CONSTRAINT_NAME = B.CONSTRAINT_NAME
			   AND A.OWNER = 'INSTC'
			   AND A.CONSTRAINT_TYPE = 'P'
			   AND A.TABLE_NAME = ${공통데이터테이블명}
			 ORDER BY B.POSITION
		]]>
    </statement>

    <!--  -->
    <statement name="regtCmnDatWdstHis" qPath="[GCB_MODEL_업무공통] 2.시스템명세모델::06.배치컴포넌트::01.공통데이터동기화관리::02.공통데이터배포::공통데이터배포파일생성Job::DAO::공통데이터배포파일생성Bdao::공통데이터배포내역등록" >
		<![CDATA[
			INSERT /*+ 위상규::/gcb/batch/cmnDatSynchMg/cmnDatWdst/cmnDatWdstFlCreJob/CmnDatWdstFlCre/regtCmnDatWdstHis */
			  INTO INSTC.TBGCBDM02
			(
			   공통데이터테이블명
			 , 배포작업시스템식별구분코드
			 , 배포대상시스템ID
			 , 작업기준년월일
			 , 배포작업처리회차
			 , 배포작업단계구분코드
			 , 배포파일구분코드
			 , 배포작업결과구분코드
			 , 배포대상데이터건수
			 , 배포작업시작년월일
			 , 배포작업시작시각
			 , 배포작업종료년월일
			 , 배포작업종료시각
			 , 배포작업오류발생내용
			 , 시스템최종갱신일시
			 , 시스템최종갱신식별자
			 , 시스템최종거래일시
			)
			VALUES
			(
			  ${공통데이터테이블명}
			 ,${배포작업시스템식별구분코드}
			 ,${배포대상시스템ID}
			 ,${작업기준년월일}
			 ,${배포작업처리회차}
			 ,${배포작업단계구분코드}
			 ,${배포파일구분코드}
			 ,${배포작업결과구분코드}
			 ,${배포대상데이터건수}
			 ,${배포작업시작년월일}
			 ,${배포작업시작시각}
			 ,${배포작업종료년월일}
			 ,${배포작업종료시각}
			 ,${배포작업오류발생내용}
			 ,SYSTIMESTAMP
			 ,${시스템최종갱신식별자}
			 ,${시스템최종거래일시}
			)
		]]>
    </statement>
</statements>
