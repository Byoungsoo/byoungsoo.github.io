<?xml version="1.0" encoding="utf-8"?>

<devon-batch>
	<id>
		<name>SHELL</name>
		<server-key></server-key>
	</id>
	<env>        
        <user-id>batch</user-id>
        <server-div-cd>AP</server-div-cd> <!-- AP : 상품처리계, BA : 배치서버 -->
    </env>        
	
	<thread-pool>
		<number-of-thread-for-job-execution>50</number-of-thread-for-job-execution>
		<number-of-thread-for-step-execution>40</number-of-thread-for-step-execution>
	</thread-pool>

	<database>
		<spec>devon</spec>		
		<core-query-path>/devon/asis/enterprise-batch</core-query-path>
		<!-- EXTENSION Batch -->
		<extension-core-query-path>/devon/lower/enterprise-batch-extension</extension-core-query-path>
		<batch>/devonbatch/batch</batch>
		<timestamp-format>yyyy-MM-dd HH:mm:ss.SSSSSS</timestamp-format>
	</database>
	
	<!-- 배치 프레임워크가 참조하는 IN/OUT 파일이 저장 될 폴더: 서버별 설정  -->
	<file>
		<base-dir-list>
			<base-dir key="default" value="#home/../devonhome-batch/file/"/>	
			<base-dir key="local" value="#home/../devonhome-batch/file/"/>
			<base-dir key="server" value="/fsfile/"/>
			<base-dir key="fsdata" value="/fsdata/"/>
			<base-dir key="bcv" value="#home/../devonhome-batch/file/"/>
		</base-dir-list>
		
		<base-dir-validator-class>
			devon.batch.item.builder.validator.ItemInformationBuilderValidator
		</base-dir-validator-class>
						
	</file>

	<job-context>
		<data-storage>
			<class-name>devon.batch.context.storage.ParameterInfoStorage</class-name>
		</data-storage>
	</job-context>
 
 	<stop-monitoring>
 		<enabled>true</enabled>
 		<interval>1000</interval>
 	</stop-monitoring>
 	
	<http-response>
		<encoding>ms949</encoding>
	</http-response>
	
	<!-- 시스템 로그 설정 -->
	<file-log>
		<system-logger-name>batinfo</system-logger-name>
		<debug-enabled>false</debug-enabled>
		
		<!-- 파일 로그의 원격 전송 설정 -->
		<transfer-option>
			<encoding>ms949</encoding>
			<lines-per-page>10</lines-per-page>
		</transfer-option>
		
		<log-aware-class>
			devon.batch.log.DefaultLogAware
		</log-aware-class>
		
	</file-log>
	 
	<persistences>
		<persistence spec="default">
			<config key="batchExecution" class="devon.batch.persistence.dao.BatchExecutionDao"/>
			<config key="createJobDescriptor" class="devon.batch.persistence.dao.CreateJobDescriptorDao"/>				
			<config key="execUserLogTx" class="devon.batch.persistence.dao.ExecUserLogTxDao"/>		
			<config key="exceptionRegister" class="devon.batch.persistence.dao.ExceptionRegisterDao"/>			
			<config key="parameter" class="devon.batch.persistence.dao.ParameterDao"/>								
			<config key="fileReporter" class="devon.batch.persistence.dao.FileReporterDao"/>		
			<config key="residential" class="devon.batch.persistence.dao.ResidentialDao"/>		
			<config key="scheduler" class="devon.batch.persistence.dao.SchedulerDao"/>
			<config key="statusReporter" class="devon.batch.persistence.dao.StatusReporterDao"/>
			<config key="itemInformation" class="devon.batch.persistence.dao.ItemInformationDao"/>		
		</persistence>		
	</persistences>
	 
		
	<observers>
		<!-- level = executor, group, job -->
		
		<!-- 상태보고자  -->
		<!-- 보고주기(ms): 동기모드 = 0 -->
		<!-- 상태변화가없으면 경고  -->
		<observer class="devon.batch.reporter.PeriodicDatabaseReporter">
			<config key="isDebug" value="true"/>
			<config key="interval" value="5000"/>		
			<config key="warning" value= "300000"/>
		</observer>

	</observers>
	
	<executors>
		<job-executor-class>
			devon.batch.shell.JobExecutor
		</job-executor-class>
		
		<residential-executor-class>
			devon.batch.shell.ResidentialExecutor
		</residential-executor-class>
	</executors>
	
	<!--  Descriptor 설정 -->
	<descriptor>
		<job-descriptor-class>
			devon.batch.descriptor.job.JobDescriptor
		</job-descriptor-class>
		<step-descriptor-class>
			devon.batch.descriptor.step.StepDescriptor
		</step-descriptor-class>		
		<item-descriptor-class>
			devon.batch.descriptor.item.ItemDescriptor
		</item-descriptor-class>
	</descriptor>
	
	<parameters>
		<job-parameter-converter-class>
			devonenterprise.ext.batch.parameter.ExJobParametersConverter
		</job-parameter-converter-class>
	</parameters>
	
	<items>
		<item-information-class>
			devon.batch.item.builder.ItemInformationBuilder
		</item-information-class>
		
		<item-selector-class>
			devon.batch.item.selector.ItemClassSelector
		</item-selector-class>		
	</items>	
	
	<extensions>
		<crypto-support-class>
		    devonenterprise.ext.batch.support.CryptoSupport
		</crypto-support-class>
		<context-support-class>
			devonenterprise.ext.batch.support.ContextInjectorSupport
		</context-support-class>
		<message-support-class>
			devonenterprise.ext.batch.support.BatchExceptionRegisterSupport
		</message-support-class>
		<logger-support-class>
			devonenterprise.ext.batch.support.BatchPhaseExecSupport
		</logger-support-class>
		<ebcdic-convert-support-class>
			devonenterprise.ext.batch.support.EbcdicAsciiConvertSupport
		</ebcdic-convert-support-class>
	</extensions>
	
	<!-- 재실행 정책 설정 
	<restart-rule>
		<restart-rule-class-name>devon.batch.core.exec.restartable.DefaultRestartRule</restart-rule-class-name>
	</restart-rule>	
	-->
	<!-- 병렬 처리 설정 -->
	<parallel-processing>
		<!-- 스텝 사본의 스텝 ID를 구별하기 위한 중간자 설정 -->
		<multi-thread-step-id>-thread-</multi-thread-step-id>
		<partition-thread-step-id>-partition-</partition-thread-step-id>
	</parallel-processing>
	
	 <!-- 영업일  -->
	<pattern-date>
		<converter-class-name>devon.batch.calendar.business.BusinessCalendarPatternConverter</converter-class-name>
		<reader-class-name>devon.batch.calendar.business.BusinessCalendarPatternReader</reader-class-name>
		<parser-class-name>devon.batch.calendar.business.BusinessCalendarPatternParser</parser-class-name>
	</pattern-date>
	
	
	<!-- 온라인 배치 환경 설정 -->
	<ondemand-batch>
  		<server name="window">  		
	  		<directory>C:\KBCARD_DEV\DOMA\workspace\KBCARD_SZC\shl</directory>  		
	            <controller>cmd.exe</controller>
	            <shell>exeBatJob.cmd</shell>
	            <option>/c</option>
	        </server>
        <server name="server">
            <directory>/fsbatch/batch-config/exe</directory>           
            <controller>/usr/bin/sh</controller>
            <shell>exeBatJob.sh</shell>
            <option></option>
        </server>       
 	</ondemand-batch>
 	
 	<mft-info>
 		<directory>/fsutil/eai/mftscript</directory>           
        <controller>/usr/bin/sh</controller>
        <shell>exeMftMultiJob.sh</shell>
 	</mft-info>
 	
 	<error-code>
		<none-code>I9900978</none-code>
 		<return-fail>SMP_MSG_ERR_710</return-fail>
 	</error-code> 

    <service name="kb-biz-class">
        <module name="GCB001">  <!-- 장애관리시스템(공통) 모듈(배치 처리 시작 시간 반영) -->
            <class-name>com.kbcard.gcb.cpbi.itObstMgSpt.bchVln.bchPrcStTtmRflcCpbi.BchPrcStTtmRflcCpbc</class-name>
            <method-name>rflcBchPrcStTtm</method-name>
        </module>
        <module name="GCB002">  <!-- 장애관리시스템(공통) 모듈(배치 통계 개별 검증) -->
            <class-name>com.kbcard.gcb.cpbi.itObstMgSpt.bchVln.bchSttcVlnCpbi.BchSttcVlnCpbc</class-name>
            <method-name>verifyBchSttc</method-name>
        </module>
        <module name="GCB003">  <!-- ITSDD-600 : GCB 영역 SMS 처리 IBI 모듈(배치작업 모니터링) -->
            <class-name>com.kbcard.common.ibi.gcb.cPBI.itOpSpt.smsMg.smsInfOferCpbi.SmsInfOferCibc</class-name>
            <method-name>prcSmsMsgTrs</method-name>
        </module>         	
 	</service>	
</devon-batch>
