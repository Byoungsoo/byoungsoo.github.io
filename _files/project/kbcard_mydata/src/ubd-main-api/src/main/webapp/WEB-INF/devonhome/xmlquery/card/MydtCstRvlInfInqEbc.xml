<?xml version="1.0" encoding="UTF-8"?>
<statements>

    <statement name="selectRvlBlExistYn">
		<![CDATA[
		SELECT /*+ 장민석:: card/MydtCstRvlInfInqEbc.xml/selectRvlBlExistYn */ 
		    	 DECODE(COUNT(1),0,'0','1') AS 존재여부_V1
		  FROM INSTC.TBUBDG007 A        /* GBC리볼빙매출전표기본(TBGBCJ003) */
		 WHERE 1=1
		   AND A.회원일련번호       = ${회원일련번호}
		   AND A.테이블파티션구분번호   = SUBSTR(${회원일련번호}, -2)
		   AND A.카드거래처리구분코드   = '1'
		   AND A.청구후잔액        > 0
		   AND A.청구보류등록구분코드 != '1'
		   AND A.구매전용은행연계구분코드 < '3'
		   AND ROWNUM = 1
		]]>
    </statement>

    <statement name="selectMbrBasMdPplPrg">
		<![CDATA[
		SELECT /*+ 장민석:: card/MydtCstRvlInfInqEbc.xml/selectMbrBasMdPplPrg */ 
		       C.회원일련번호
		     , C.회원기본중요변경유형구분코드
		     , C.회원기본처리일련번호
		     , C.회원기본처리관리번호
		     , C.회원기본처리회차
		     , C.처리년월일
		     , C.처리시각
		     , C.처리부점코드
		     , C.처리직원번호
		     , C.처리단말번호
		     , C.상대부점코드
		     , C.회원카드추가구분코드
		     , C.회원정보변경추가내용1
		     , C.회원정보변경추가내용2
		     , C.담당자메모고객정보1
		     , C.담당자메모고객정보2
		     , C.해제년월일
		     , C.해제시각
		     , C.해제부점코드
		     , C.해제직원번호
		     , C.해제단말번호
		     , C.리볼빙예약일련번호
		     , C.리볼빙약정률
		     , C.리볼빙대상금액
		     , C.리볼빙일시불수수료율
		     , C.리볼빙CA수수료율
		     , C.카드거래매체구분코드
		     , C.거래년월일
		     , C.거래부점코드
		     , C.거래직원번호
		     , C.리볼빙최소상환비율
		     , C.리볼빙최소상환금액
		     , C.리볼빙임시약정률
		     , C.리볼빙임시청구년월일
		     , C.리볼빙등록전이용금액포함여부
		     , C.구리볼빙최소불입액
		     , C.서비스약정종료년월일
		     , C.리볼빙약정기간년수
		     , C.역할유형구분코드
		     , C.권유자번호
		     , C.리볼빙취급구분코드
		     , C.리볼빙매출구분코드
		     , C.리볼빙등록구분코드
		     , C.리볼빙해제사유구분코드
		     , C.화면거래처리구분코드
		     , C.금융취약보호계층구분코드
		     , C.자동연장구분코드
		  FROM (
		        SELECT 
		               A.회원일련번호
		             , A.회원기본중요변경유형구분코드
		             , A.회원기본처리일련번호
		             , A.회원기본처리관리번호
		             , A.회원기본처리회차
		             , A.처리년월일
		             , A.처리시각
		             , A.처리부점코드
		             , A.처리직원번호
		             , A.처리단말번호
		             , A.상대부점코드
		             , A.회원카드추가구분코드
		             , A.회원정보변경추가내용1
		             , A.회원정보변경추가내용2
		             , A.담당자메모고객정보1
		             , A.담당자메모고객정보2
		             , A.해제년월일
		             , A.해제시각
		             , A.해제부점코드
		             , A.해제직원번호
		             , A.해제단말번호
		             , B.리볼빙예약일련번호
		             , B.리볼빙약정률
		             , B.리볼빙대상금액
		             , B.리볼빙일시불수수료율
		             , B.리볼빙CA수수료율
		             , B.카드거래매체구분코드
		             , B.거래년월일
		             , B.거래부점코드
		             , B.거래직원번호
		             , B.리볼빙최소상환비율
		             , B.리볼빙최소상환금액
		             , B.리볼빙임시약정률
		             , B.리볼빙임시청구년월일
		             , B.리볼빙등록전이용금액포함여부
		             , B.구리볼빙최소불입액
		             , B.서비스약정종료년월일
		             , B.리볼빙약정기간년수
		             , B.역할유형구분코드
		             , B.권유자번호
		             , B.리볼빙취급구분코드
		             , B.리볼빙매출구분코드
		             , B.리볼빙등록구분코드
		             , B.리볼빙해제사유구분코드
		             , B.화면거래처리구분코드
		             , B.금융취약보호계층구분코드
		             , B.자동연장구분코드
		          FROM INSTC.TBUBDO003 A /* GAC회원기본중요변경내역(TBGACHW05) */
		             , INSTC.TBUBDO006 B /* GAC일부결제금액이월약정내역(TBGACHW18) */
		         WHERE A.회원일련번호         = ${회원일련번호}
		           AND A.회원기본중요변경유형구분코드 = '101'
		           AND (${처리여부_V1} IS NULL
		                OR (${처리여부_V1} = '1'
		                 AND A.처리년월일          = ${처리년월일})
		                OR (${처리여부_V1} = '2'
		                 AND A.처리년월일          <= ${처리년월일})
		               )  
		           AND (${해제여부_V1} <> '1'
		                OR (${해제여부_V1} = '1'
		                 AND A.해제년월일 IS NULL)
		               )  
		           AND A.회원일련번호 = B.회원일련번호         
		           AND A.회원기본중요변경유형구분코드 = B.회원기본중요변경유형구분코드       
		           AND A.회원기본처리일련번호     = B.회원기본처리일련번호
		         ORDER BY A.회원기본처리일련번호     DESC
		                , B.리볼빙예약일련번호 DESC
		       ) C   
		 WHERE ROWNUM = 1
		]]>
    </statement>
    
    <statement name="selectRvlCrfBl">
		<![CDATA[
		SELECT /*+ 장민석:: card/MydtCstRvlInfInqEbc.xml/selectRvlCrfBl */ 
		       SUM(A.청구후잔액) AS 리볼빙이월잔액_N15
		  FROM INSTC.TBUBDG007 A  /*GBC리볼빙매출전표기본(THKBCJP04)-(TBGBCJ003)*/
		 WHERE A.회원일련번호              = ${회원일련번호}
		   AND A.테이블파티션구분번호      = SUBSTR(${회원일련번호}, -2) 
		   AND A.카드거래처리구분코드      = '1'
		   AND A.청구후잔액                > 0      
		   AND A.청구회차                  >= 1             
		   AND A.청구보류등록구분코드     != '1'
		   AND A.구매전용은행연계구분코드  < '3'
		]]>
    </statement>
    
</statements>
