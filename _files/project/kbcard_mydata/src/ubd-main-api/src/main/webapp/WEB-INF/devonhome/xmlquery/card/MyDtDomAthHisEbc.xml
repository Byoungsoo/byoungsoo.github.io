<?xml version="1.0" encoding="UTF-8"?>
<statements>
    <statement name="retvGagAltrCrdDtlByCrdAltrNo"> 
        <![CDATA[ /*카드대체번호대체카드상세단건조회*/
           SELECT /*+ 김민성::::/card/MyDtDomAthHisEbc/retvLstMydtAthHis/retvGagAltrCrdDtlByCrdAltrNo */ 
       A.카드식별자
     , A.카드상세일련번호
     , A.회원일련번호
  FROM INSTC.TBUBDE005 A /*구 TBGAGCD20 GAG대체카드상세*/
 WHERE A.카드대체번호 = ${카드대체번호}
   AND ROWNUM = 1
        ]]>
    </statement>
    
    
      <statement name="retvGagCrdDtl"> 
        <![CDATA[ /*카드대체번호대체카드상세단건조회*/
    SELECT /*+ 김민성::/card/MyDtDomAthHisEbc/retvLstMydtAthHis/retvGagCrdDtl */ 
       A.카드식별자
     , A.카드상세일련번호
     , A.BIN번호
     , A.카드만료년월일
     , A.등록부점코드
     , A.등록년월일
     , A.상품대분류구분코드
     , A.상품중분류구분코드
     , A.카드등급그룹코드
     , A.상품코드
     , A.상품번호
     , A.고객선택자재구분코드
     , A.카드등급구분코드
     , A.카드브랜드구분코드
     , A.카드브랜드상세구분코드
     , A.사진도착구분코드
     , A.인자구분코드
     , A.하이코방식여부
     , A.모바일카드종류구분코드
     , A.신청서접수번호
     , A.신청서접수대상여부
     , A.카드신청서이미지저장여부
     , A.권유자번호
     , A.역할유형구분코드
     , A.발급유형구분코드
     , A.발급유형구분시기구분코드
     , A.카드거래매체구분코드
     , A.유선발급구분코드
     , A.카드등급변경여부
     , A.카드도난분실발급여부
     , A.교체카드여부
     , A.갱신카드여부
     , A.강제발급구분코드
     , A.카드우선발급여부
     , A.수령지주소구분코드
     , A.발송기관구분코드
     , A.카드교부년월일
     , A.교부유형구분코드
     , A.카드교부희망부점코드
     , A.가족회원앞교부필수여부
     , A.실물보유구분코드
     , A.카드실물보유부점코드
     , A.카드반송년월일
     , A.카드반송회차
     , A.제휴관리번호
     , A.교통카드PL번호
     , A.전자화폐번호
     , A.카드비밀번호
     , A.앞2자리카드비밀번호
     , A.뒤2자리카드비밀번호
     , A.비밀번호오류발생년월일
     , A.비밀번호일오류횟수
     , A.비밀번호오류누적횟수
     , A.CVC오류누적횟수
     , A.CD기기능구분코드
     , A.CD상태구분코드
     , A.현금카드발급번호
     , A.현금카드1차난수번호
     , A.현금카드2차난수번호
     , A.신용계좌CSN번호
     , A.현금계좌CSN번호
     , A.회원일련번호
     , A.카드구분키번호
     , A.최종카드여부
     , A.해지년월일
     , A.패키지상품접수일련번호
     , A.패키지상품종류구분코드
     , A.고객검증카드번호
     , A.카드번호뒤4자리번호
     , A.원장생성년월일
     , TO_CHAR(시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
     , A.시스템최종갱신식별자
     , A.시스템최종거래일시
  FROM INSTC.TBUBDE003 A /*구 GAG카드상세 TBGAGCD02 A */
 WHERE A.카드식별자 = ${카드식별자}
   AND A.카드상세일련번호 = ${카드상세일련번호}
           ]]>
    </statement>
    
    <statement name="retvLstMydtAthHis"> 
        <![CDATA[  /* 마이데이터승인내역목록조회 6개월 이전 */
   SELECT /*+ INDEX (A XBGBHA501A04)  김민성::/card/MyDtDomAthHisEbc/retvLstMydtAthHis */ 
       A.회원일련번호
     , A.매출승인번호
     , A.승인년월일 /*oooooo*/
     , A.매출승인시각 /*oooooo*/
     , A.국내외구분코드
     , A.카드식별자
     , A.입력카드유효기한년월
     , A.카드승인상태구분코드
     , A.전표매입년월일
     , A.매출전표번호
     , A.매출전표접수년월일
     , A.EDIDRAFT구분코드
     , A.전문거래구분번호
     , A.카드승인금액                /*oooooo*/
     , A.해외승인미화금액
     , A.전표매입누계금액
     , A.할부개월수
     , A.가맹점소속회사구분코드
     , A.가맹점번호
     , A.상품코드
     , A.상품대분류구분코드
     , A.상품중분류구분코드
     , A.카드등급그룹코드
     , A.상품번호
     , A.사업자등록번호
     , A.가맹점업종코드
     , A.해외업종그룹구분코드
     , A.카드금융제휴기관구분코드
     , A.ISO국가번호코드
     , A.ISO국가코드
     , A.ISO통화코드
     , A.SWIPE구분코드
     , A.CVC2번호
     , A.승인거래전송처리구분코드
     , A.채널구분코드
     , A.채널세부업무구분코드
     , A.매체구분코드
     , A.승인한도반영구분코드
     , A.카드매출유형구분코드
     , A.강제승인구분코드
     , A.마감후거래여부
     , A.비밀번호확인구분코드
     , A.승인대외기관구분코드
     , A.단말기관리번호
     , A.거래부점코드
     , A.거래코드
     , A.당사승인년월일
     , A.당사승인시각
     , A.어음만기년월일
     , A.구매카드매입개시가능년월일
     , A.KB국민은행거래년월일
     , A.KB국민은행거래취소년월일
     , A.사이버ID
     , A.승인한도금액
     , A.승인이용한도구분코드
     , A.특별승인기준금액반영여부
     , A.특별승인금액
     , A.특별한도업무구분코드
     , A.특별한도승인금액
     , A.일반한도승인금액
     , A.카드한도사용여부
     , A.카드한도사용금액
     , A.가족카드지정승인여부
     , A.한도등급코드
     , A.CBS평점
     , A.가맹점EDIDRAFT표시내용
     , A.업무유형구분코드
     , A.지급결제고도화구분코드
     , A.해외매입사ID
     , A.대행승인번호
     , A.승인취소구분코드
     , A.승인취소불가구분코드
     , A.승인취소년월일                /*oooooo*/
     , A.승인취소시각                  /*oooooo*/
     , A.승인취소CAT번호
     , A.승인취소단말번호
     , A.승인취소역할유형구분코드
     , A.승인취소직원번호
     , A.카드입력구분코드
     , A.전문거래고유번호
     , A.환급처리여부
     , A.승인잔여한도금액
     , A.할인금액
     , A.봉사료
     , A.PG입점업체사업자등록번호
     , A.KBBC카드여부
     , A.부가가치세
     , A.포인트사용승인여부
     , A.포인트사용금액
     , A.로얄티승인구분코드
     , A.로열티가맹점구분코드
     , A.로얄티적용전금액
     , A.채널IP주소
     , A.국제브랜드승인전문참조내용
     , A.승인특정업무구분코드
     , A.카드승인단말기전표구분코드
     , A.승인특정매체구분코드
     , A.승인신용체크구분코드
     , A.전자상거래번호
     , A.거래취소정정사유구분코드
     , A.거래취소정정사유내용
     , A.실적마감카드승인상태구분코드
     , TO_CHAR(A.시스템최초생성일시, 'YYYYMMDDHH24MISS') as 시스템최초생성일시
     , A.시스템최초생성식별자
     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
     , A.시스템최종갱신식별자
     , A.시스템최종거래일시
     , A.전자서명전표여부
  FROM INSTC.TBUBDI001 A /* 구 TBGBHA501 GBH매출승인내역 */
 WHERE A.회원일련번호 = ${회원일련번호}
   AND A.카드식별자 = ${카드식별자}
   AND A.국내외구분코드 = ${국내외구분코드}
   AND A.승인년월일  BETWEEN  ${승인년월일1} AND ${승인년월일2}
   AND A.카드승인상태구분코드  NOT IN ('07','09', '14', '88', '99', 'ZZ')
        ]]>
    </statement>
    
        <statement name="retvLstMydtPstAthHis">    
        <![CDATA[ /* 마이데이터과거승인내역목록조회 6개월 이후*/
   SELECT /* 김민성::/card/MyDtDomAthHisEbc/selectMyDtDomAthHisa6 */ 
       A.회원일련번호
     , A.매출승인번호
     , A.승인년월일
     , A.매출승인시각
     , A.국내외구분코드
     , A.카드식별자
     , A.입력카드유효기한년월
     , A.카드승인상태구분코드
     , A.전표매입년월일
     , A.매출전표번호
     , A.매출전표접수년월일
     , A.EDIDRAFT구분코드
     , A.전문거래구분번호
     , A.카드승인금액
     , A.해외승인미화금액
     , A.전표매입누계금액
     , A.할부개월수
     , A.가맹점소속회사구분코드
     , A.가맹점번호
     , A.상품코드
     , A.상품대분류구분코드
     , A.상품중분류구분코드
     , A.카드등급그룹코드
     , A.상품번호
     , A.사업자등록번호
     , A.가맹점업종코드
     , A.해외업종그룹구분코드
     , A.카드금융제휴기관구분코드
     , A.ISO국가번호코드
     , A.ISO국가코드
     , A.ISO통화코드
     , A.SWIPE구분코드
     , A.CVC2번호
     , A.승인거래전송처리구분코드
     , A.채널구분코드
     , A.채널세부업무구분코드
     , A.매체구분코드
     , A.승인한도반영구분코드
     , A.카드매출유형구분코드
     , A.강제승인구분코드
     , A.마감후거래여부
     , A.비밀번호확인구분코드
     , A.승인대외기관구분코드
     , A.단말기관리번호
     , A.거래부점코드
     , A.거래코드
     , A.당사승인년월일
     , A.당사승인시각
     , A.어음만기년월일
     , A.구매카드매입개시가능년월일
     , A.KB국민은행거래년월일
     , A.KB국민은행거래취소년월일
     , A.사이버ID
     , A.승인한도금액
     , A.승인이용한도구분코드
     , A.특별승인기준금액반영여부
     , A.특별승인금액
     , A.특별한도업무구분코드
     , A.특별한도승인금액
     , A.일반한도승인금액
     , A.카드한도사용여부
     , A.카드한도사용금액
     , A.가족카드지정승인여부
     , A.한도등급코드
     , A.CBS평점
     , A.가맹점EDIDRAFT표시내용
     , A.업무유형구분코드
     , A.지급결제고도화구분코드
     , A.해외매입사ID
     , A.대행승인번호
     , A.승인취소구분코드
     , A.승인취소불가구분코드
     , A.승인취소년월일
     , A.승인취소시각
     , A.승인취소CAT번호
     , A.승인취소단말번호
     , A.승인취소역할유형구분코드
     , A.승인취소직원번호
     , A.카드입력구분코드
     , A.전문거래고유번호
     , A.환급처리여부
     , A.승인잔여한도금액
     , A.할인금액
     , A.봉사료
     , A.PG입점업체사업자등록번호
     , A.KBBC카드여부
     , A.부가가치세
     , A.포인트사용승인여부
     , A.포인트사용금액
     , A.로얄티승인구분코드
     , A.로열티가맹점구분코드
     , A.로얄티적용전금액
     , A.채널IP주소
     , A.국제브랜드승인전문참조내용
     , A.승인특정업무구분코드
     , A.카드승인단말기전표구분코드
     , A.승인특정매체구분코드
     , A.승인신용체크구분코드
     , A.전자상거래번호
     , A.거래취소정정사유구분코드
     , A.거래취소정정사유내용
     , A.실적마감카드승인상태구분코드
     , TO_CHAR(A.시스템최초생성일시, 'YYYYMMDDHH24MISS') as 시스템최초생성일시
     , A.시스템최초생성식별자
     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
     , A.시스템최종갱신식별자
     , A.시스템최종거래일시
     , A.전자서명전표여부
  FROM INSTC.TBUBDI001 A /* 구 TBGBHA501 GBH매출승인내역 */
 WHERE A.회원일련번호 = ${회원일련번호}
   AND A.카드식별자 = ${카드식별자}
   AND A.국내외구분코드 = ${국내외구분코드}
   AND A.승인년월일  BETWEEN  ${승인년월일1} AND ${승인년월일2}
   AND A.카드승인상태구분코드  NOT IN ('07','09', '14', '88', '99', 'ZZ')
   
UNION ALL

SELECT 
      A.회원일련번호
     , A.매출승인번호
     , A.승인년월일
     , A.매출승인시각
     , A.국내외구분코드
     , A.카드식별자
     , A.입력카드유효기한년월
     , A.카드승인상태구분코드
     , A.전표매입년월일
     , A.매출전표번호
     , A.매출전표접수년월일
     , A.EDIDRAFT구분코드
     , A.전문거래구분번호
     , A.카드승인금액
     , A.해외승인미화금액
     , A.전표매입누계금액
     , A.할부개월수
     , A.가맹점소속회사구분코드
     , A.가맹점번호
     , A.상품코드
     , A.상품대분류구분코드
     , A.상품중분류구분코드
     , A.카드등급그룹코드
     , A.상품번호
     , A.사업자등록번호
     , A.가맹점업종코드
     , A.해외업종그룹구분코드
     , A.카드금융제휴기관구분코드
     , A.ISO국가번호코드
     , A.ISO국가코드
     , A.ISO통화코드
     , A.SWIPE구분코드
     , A.CVC2번호
     , A.승인거래전송처리구분코드
     , A.채널구분코드
     , A.채널세부업무구분코드
     , A.매체구분코드
     , A.승인한도반영구분코드
     , A.카드매출유형구분코드
     , A.강제승인구분코드
     , A.마감후거래여부
     , A.비밀번호확인구분코드
     , A.승인대외기관구분코드
     , A.단말기관리번호
     , A.거래부점코드
     , A.거래코드
     , A.당사승인년월일
     , A.당사승인시각
     , A.어음만기년월일
     , A.구매카드매입개시가능년월일
     , A.KB국민은행거래년월일
     , A.KB국민은행거래취소년월일
     , A.사이버ID
     , A.승인한도금액
     , A.승인이용한도구분코드
     , A.특별승인기준금액반영여부
     , A.특별승인금액
     , A.특별한도업무구분코드
     , A.특별한도승인금액
     , A.일반한도승인금액
     , A.카드한도사용여부
     , A.카드한도사용금액
     , A.가족카드지정승인여부
     , A.한도등급코드
     , A.CBS평점
     , A.가맹점EDIDRAFT표시내용
     , A.업무유형구분코드
     , A.지급결제고도화구분코드
     , A.해외매입사ID
     , A.대행승인번호
     , A.승인취소구분코드
     , A.승인취소불가구분코드
     , A.승인취소년월일
     , A.승인취소시각
     , A.승인취소CAT번호
     , A.승인취소단말번호
     , A.승인취소역할유형구분코드
     , A.승인취소직원번호
     , A.카드입력구분코드
     , A.전문거래고유번호
     , A.환급처리여부
     , A.승인잔여한도금액
     , A.할인금액
     , A.봉사료
     , A.PG입점업체사업자등록번호
     , A.KBBC카드여부
     , A.부가가치세
     , A.포인트사용승인여부
     , A.포인트사용금액
     , A.로얄티승인구분코드
     , A.로열티가맹점구분코드
     , A.로얄티적용전금액
     , A.채널IP주소
     , A.국제브랜드승인전문참조내용
     , A.승인특정업무구분코드
     , A.카드승인단말기전표구분코드
     , A.승인특정매체구분코드
     , A.승인신용체크구분코드
     , A.전자상거래번호
     , A.거래취소정정사유구분코드
     , A.거래취소정정사유내용
     , A.실적마감카드승인상태구분코드
     , TO_CHAR(A.시스템최초생성일시, 'YYYYMMDDHH24MISS') as 시스템최초생성일시
     , A.시스템최초생성식별자
     , TO_CHAR(A.시스템최종갱신일시, 'YYYYMMDDHH24MISS') as 시스템최종갱신일시
     , A.시스템최종갱신식별자
     , A.시스템최종거래일시
     , A.전자서명전표여부
  FROM INSTC.TBUBDI002 A  /* 구 TBGBHA504 GBH과거매출승인내역 */
 WHERE A.회원일련번호 = ${회원일련번호}
   AND A.카드식별자 = ${카드식별자}
   AND A.국내외구분코드 = ${국내외구분코드}
   AND A.승인년월일  BETWEEN  ${승인년월일1} AND ${승인년월일2}
   AND A.카드승인상태구분코드  NOT IN ('07','09', '14', '88', '99', 'ZZ')

   
          ]]>
    </statement>
    
        <statement name="retvGdbMmcBas"> 
        <![CDATA[ /*카드금융제휴기관구분코드 070(국민카드) 가맹점명 조회*/
	SELECT /* 김민성::/card/MyDtDomAthHisEbc/retvGdbMmcBas */  
	       A.가맹점번호 AS 가맹점번호 ,
	       B.가맹점명 AS 가맹점명,
	       C.고객고유번호 AS 사업자등록번호
  FROM INSTC.TBUBDM001 A, /*구 TBGDBC001 */
       INSTC.TBUBDA002 B,  /*구 TBGAAA002 */
       INSTC.TBUBDA001 C   /*구 TBGAAA001 */
	 WHERE A.가맹점번호 =${가맹점번호}
	   AND B.고객식별자 = A.기업고객식별자
	   AND B.고객관리번호 = A.기업고객관리번호 
	   AND B.고객식별자 = C.고객식별자
        ]]>
            </statement>
           <statement name="retvGDB_BcMmcBas"> 
       <![CDATA[ /*카드금융제휴기관구분코드 098(비씨) 가맹점명 조회*/
		SELECT /*+ 김민성::::/card/MyDtDomAthHisEbc/retvLstMydtAthHis/retvGDB_BcMmcBas */ 
		       A.BC카드가맹점명
		       A.BC카드가맹점사업자등록번호
		  FROM INSTC.TBUBDM002 A /*구 TBGDBG001*/
		 WHERE A.BC카드가맹점번호 = ${BC카드가맹점번호}
		 
       ]]>
            </statement>
            <statement name="retvLstGdbFnbbMmc"> 
        <![CDATA[ /*카드금융제휴기관구분코드 공동가맹점 가맹점명 조회*/
           SELECT /*+ 김민성::::/card/MyDtDomAthHisEbc/retvLstMydtAthHis/retvLstGdbFnbbMmc */ 
       *
  FROM (
        SELECT A.공동망가맹점사업자등록번호
             , A.공동망기관구분코드
             , A.공동망요청기관구분코드
             , A.공동망가맹점번호
             , A.공동망가맹점명
             , A.공동망가맹점대상여부
             , A.공동망가맹점등재여부
             , A.공동망특약대상여부
             , A.공동망할부가능여부
             , A.공동망중복가맹여부
             , A.공동망가맹점불량등재여부
             , A.공동망정산용업종코드
             , A.변경전공동망정산용업종코드
             , A.공동망가맹점주주민등록번호
             , A.변경전가맹점주주민등록번호
             , A.공동망변경전사업자등록번호
             , A.공동망가맹점신규년월일
             , A.공동망가맹점해지년월일
             , A.공동망가맹점해지구분코드
             , A.공동망가맹점해지구분코드1
             , A.공동망가맹점해지구분코드2
             , A.공동망가맹점대표자명
             , A.공동망가맹점전화번호
             , A.공동망가맹점우편번호
             , A.공동망가맹점기본주소
             , A.공동망가맹점상세주소
             , A.공동망업무구분코드
             , A.공동망변경거래구분코드
             , A.공동망정보제공년월일
             , A.공동망정보수신년월일
             , A.변경전공동망등록년월일
             , A.공동망공동이용등록년월일
             , A.사업자등록번호변경년월일
             , A.대표자주민등록번호변경년월일
             , A.공동망부적격등록년월일
             , A.공동망특약변경년월일
             , A.공동망가맹점협회반송년월일
             , A.공동망강제해제년월일
             , A.시스템최종갱신일시
             , A.시스템최종갱신식별자
             , A.시스템최종거래일시
          FROM INSTC.TBGDBH002 A
          WHERE ${공동망가맹점번호}  IS NOT NULL
            AND A.공동망가맹점번호 = ${공동망가맹점번호} 
            AND (${공동망가맹점사업자등록번호} IS NULL OR A.공동망가맹점사업자등록번호 = ${공동망가맹점사업자등록번호})
            AND (${공동망기관구분코드}         IS NULL OR A.공동망기관구분코드         = ${공동망기관구분코드})
        UNION ALL
        SELECT A.공동망가맹점사업자등록번호
             , A.공동망기관구분코드
             , A.공동망요청기관구분코드
             , A.공동망가맹점번호
             , A.공동망가맹점명
             , A.공동망가맹점대상여부
             , A.공동망가맹점등재여부
             , A.공동망특약대상여부
             , A.공동망할부가능여부
             , A.공동망중복가맹여부
             , A.공동망가맹점불량등재여부
             , A.공동망정산용업종코드
             , A.변경전공동망정산용업종코드
             , A.공동망가맹점주주민등록번호
             , A.변경전가맹점주주민등록번호
             , A.공동망변경전사업자등록번호
             , A.공동망가맹점신규년월일
             , A.공동망가맹점해지년월일
             , A.공동망가맹점해지구분코드
             , A.공동망가맹점해지구분코드1
             , A.공동망가맹점해지구분코드2
             , A.공동망가맹점대표자명
             , A.공동망가맹점전화번호
             , A.공동망가맹점우편번호
             , A.공동망가맹점기본주소
             , A.공동망가맹점상세주소
             , A.공동망업무구분코드
             , A.공동망변경거래구분코드
             , A.공동망정보제공년월일
             , A.공동망정보수신년월일
             , A.변경전공동망등록년월일
             , A.공동망공동이용등록년월일
             , A.사업자등록번호변경년월일
             , A.대표자주민등록번호변경년월일
             , A.공동망부적격등록년월일
             , A.공동망특약변경년월일
             , A.공동망가맹점협회반송년월일
             , A.공동망강제해제년월일
             , A.시스템최종갱신일시
             , A.시스템최종갱신식별자
             , A.시스템최종거래일시
          FROM INSTC.TBGDBH002 A
         WHERE ${공동망가맹점번호}  IS NULL
           AND ${공동망가맹점사업자등록번호} IS NOT NULL
           AND A.공동망가맹점사업자등록번호 = ${공동망가맹점사업자등록번호}
           AND (${공동망기관구분코드} IS NULL OR A.공동망기관구분코드 = ${공동망기관구분코드})
       )
 ORDER BY DECODE(${공동망가맹점번호} , null , 공동망기관구분코드, 공동망가맹점사업자등록번호)
        ]]>
            </statement>



</statements>